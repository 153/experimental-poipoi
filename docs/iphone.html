<!doctype html>
<html lang="ja">
<head>
<title>ぽいぽいスクリプト</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>:target{display:none}</style>
</head>
<body>
<h1>iPhone iPadでスクリプト</h1>
<figure id="sp">
<figcaption>このページのQRコード</figcaption>
<img src="iqr.png">
</figure>
<h2>準備</h2>
<p>この準備は最初の１回だけやればOKです。
<ol>
<li>このページをiPhone iPadで開く
<li>このページをブックマーク
<li>これをタップする→<input type="text" id="bookmarklet" style="font-size:1em" readonly>
<li>ブックマークを開いて右下の編集を押す
<li>ぽいぽいスクリプトをタップ
<li>URLのところを全消ししてさっきコピーしたやつを貼り付け
<li>完了を押す
</ol>
<h2>使い方</h2>
<ol>
<li>ぽいぽいを開く
<li>ブックマークを開き、ぽいぽいスクリプトをタップ
</ol>
<p>ブックマークを実行すると一番下に無音のオーディオトラックが出てきますがこれを再生している間はスリープやページがバックグラウンドに行っても接続が持続します。
<script>
var input = document.getElementById('bookmarklet');
input.value = 'javascript:' + encodeURIComponent('(' + async function () {
  try {
    window.iPhoneBookmarklet = true;
    eval(await (await fetch('https://raw.githubusercontent.com/iwamizawa-software/experimental-poipoi/main/_experimental-poipoi.user.js?t=' + (new Date).getTime())).text());
  } catch (err) {
    alert(err);
  }
} + ')()');
input.onclick = function () {
  this.select();
  document.execCommand('copy');
  alert('コピーした');
};
</script>
</body>
</html>
